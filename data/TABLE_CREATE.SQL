/* 개발DB 생성 */
CREATE DATABASE LOVE_TEST;
USE LOVE_TEST;

/*
### 수업목록(LESN_LIST)
- 수업ID (LESN_ID) NUMBER(6): PK, AUTO_INCREMENT
- 수업년월(LESN_YM) VARCHAR(6)
- 수업회차(LESN_NUM) NUMBER(1)
 */
CREATE TABLE LESN_LIST
(
  LESN_ID INT AUTO_INCREMENT PRIMARY KEY ,
  LESN_YM VARCHAR(6),
  LESN_NUM INT
);

/*
### 수강생정보(STUD_INFO)
- 수강생명 (STUD_NM) VARCHAR(10): PK
- 수강생성별 (STUD_GEN) VARCHAR(1)
*/
CREATE TABLE STUD_INFO
(
  STUD_NM VARCHAR(10) NOT NULL PRIMARY KEY,
  STUD_GEN VARCHAR(1)
);
/*
### 넘버정보(NUMB_INFO)
- 작품명 (TITLE) VARCHAR(100): PK
- 넘버명 (NUMB) VARCHAR(100): PK
- 넘버성별(NUMB_GEN) VARCHAR(1)
*/
CREATE TABLE NUMB_INFO
(
  TITLE VARCHAR(100),
  NUMB VARCHAR(100),
  NUMB_GEN VARCHAR(1),

  PRIMARY KEY(TITLE, NUMB)
);
/*
### 수업정보(LESN_INFO)

- 수업회차.수업ID (LESN_ID) : FK
- 수강생정보.수강생명 (STUD_NM) : FK
- 넘버정보.작품명 (TITLE) : FK
- 넘버정보.넘버명 (NUMB) : FK
- 수업일련번호(LESN_SEQ) NUMBER(2): PK
*/
CREATE TABLE LESN_INFO
(
  LESN_ID INT NOT NULL,
  STUD_NM VARCHAR(10) NOT NULL,
  TITLE VARCHAR(100) NOT NULL,
  NUMB VARCHAR(100) NOT NULL,
  LESN_SEQ INT,

  PRIMARY KEY(LESN_ID, STUD_NM, TITLE, NUMB, LESN_SEQ),

  FOREIGN KEY(LESN_ID) REFERENCES LESN_LIST(LESN_ID)
    ON UPDATE CASCADE ON DELETE CASCADE,
  FOREIGN KEY(STUD_NM) REFERENCES STUD_INFO(STUD_NM)
    ON UPDATE CASCADE ON DELETE CASCADE,
  FOREIGN KEY(TITLE, NUMB) REFERENCES NUMB_INFO(TITLE, NUMB)
    ON UPDATE CASCADE ON DELETE CASCADE
);
